heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig <- normed[noquote(rownames(normed)) %in% noquote(unique(siggenes)),]
minisig <- as.matrix(minisig)
minisig
siggenes
view(as.data.frame(minisig))
minisig <- normed[noquote(rownames(normed)) %in% noquote(unique(siggenes)),]
minisig <- as.matrix(minisig)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production - Significant"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_positive_regulation_of_cytokine_production.pdf")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig <- normed[noquote(rownames(normed)) %in% noquote(unique(siggenes)),]
minisig <- as.matrix(minisig)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production - Significant"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig, Colv = NA, main=title)
dev.off()
minisig <- normed[noquote(rownames(normed)) %in% noquote(unique(siggenes)),]
minisig <- as.matrix(minisig)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig, Colv = NA, main=title)
dev.off()
minisig <- select(normed, contains("B"))
minisig <- select(as.data.frame(normed), contains("B"))
minisig <- normed[noquote(rownames(normed)) %in% noquote(unique(siggenes)),]
minisig <- select(as.data.frame(normed), contains("B"))
minisig <- normed[noquote(rownames(normed)) %in% noquote(unique(siggenes)),]
minisig <- as.matrix(minisig)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig, Colv = NA, main=title)
dev.off()
minisig <- select(as.data.frame(normed), contains("B"))
minisig <- minisig[noquote(rownames(minisig)) %in% noquote(unique(siggenes)),]
minisig <- as.matrix(minisig)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_60_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
go_iir <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\innate_immune_response.txt", sep = "\t", row.names = NULL, header = TRUE)
# normed140 <- as.data.frame(normed)
# normed140 <- select(normed140, contains("B"))
# normed140 <- log(normed140[!(apply(normed140, 1, function(y) any(y == 0))),])
# x <- c("Cxcl16","Nos2")
# normed140 <- normed140[rownames(normed140) %in% x,]
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
pdf(file = "innate_immune_response2.pdf")
title = "Innate Immune Response"
heatmap(mininormed,Colv = NA, main=title)
dev.off()
# mininormed <- normed140[noquote(rownames(normed140)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
#   mininormed <- as.matrix(mininormed)
#   setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
#   pdf(file = "innate_immune_response2.pdf")
#   title = "Innate Immune Response"
#   heatmap(mininormed,Colv = NA, main=title)
#   dev.off()
go_procp <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\positive_regulation_of_cytokine_production.txt", sep = "\t", row.names = NULL, header = TRUE)
# normed140 <- as.data.frame(normed)
# normed140 <- select(normed140, contains("B"))
# normed140 <- log(normed140[!(apply(normed140, 1, function(y) any(y == 0))),])
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "positive_regulation_of_cytokine_production.pdf")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_60_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
go_procp <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\positive_regulation_of_cytokine_production.txt", sep = "\t", row.names = NULL, header = TRUE)
# normed140 <- as.data.frame(normed)
# normed140 <- select(normed140, contains("B"))
# normed140 <- log(normed140[!(apply(normed140, 1, function(y) any(y == 0))),])
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "positive_regulation_of_cytokine_production.pdf")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "sig_60_positive_regulation_of_cytokine_production.pdf")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
go_iir <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\innate_immune_response.txt", sep = "\t", row.names = NULL, header = TRUE)
# normed140 <- as.data.frame(normed)
# normed140 <- select(normed140, contains("B"))
# normed140 <- log(normed140[!(apply(normed140, 1, function(y) any(y == 0))),])
# x <- c("Cxcl16","Nos2")
# normed140 <- normed140[rownames(normed140) %in% x,]
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
pdf(file = "innate_immune_response.pdf")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
pdf(file = "sig_innate_immune_response.pdf")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
pdf(file = " sig_60_innate_immune_response.pdf")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
go_procp <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\positive_regulation_of_cytokine_production.txt", sep = "\t", row.names = NULL, header = TRUE)
# normed140 <- as.data.frame(normed)
# normed140 <- select(normed140, contains("B"))
# normed140 <- log(normed140[!(apply(normed140, 1, function(y) any(y == 0))),])
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "positive_regulation_of_cytokine_production.pdf")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "positive_regulation_of_cytokine_production_sig.pdf")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
n <- paste(title,"pdf", sep = ".'")
pdf(file = "positive_regulation_of_cytokine_production_sig60.pdf")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
go_iir <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\innate_immune_response.txt", sep = "\t", row.names = NULL, header = TRUE)
# normed140 <- as.data.frame(normed)
# normed140 <- select(normed140, contains("B"))
# normed140 <- log(normed140[!(apply(normed140, 1, function(y) any(y == 0))),])
# x <- c("Cxcl16","Nos2")
# normed140 <- normed140[rownames(normed140) %in% x,]
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
pdf(file = "innate_immune_response.pdf")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
pdf(file = "innate_immune_response_sig.pdf")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
pdf(file = "innate_immune_response_sig60.pdf")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
go_crtbs <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmpas\\cellular_response_to_biotic_stimulus.txt", sep = "\t", row.names = NULL, header = TRUE)
go_crtbs <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmpas\\cellular_response_to_biotic_stimulus.txt", sep = "\t", row.names = NULL, header = TRUE)
go_crtbs <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmpas\\cellular_response_to_biotic_stimulus.txt", sep = "\t", row.names = NULL, header = TRUE)
go_ctrbs <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\cellular_response_to_biotic_stimulus.txt", sep = "\t", row.names = NULL, header = TRUE)
go_ctrbs <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\cellular_response_to_biotic_stimulus.txt", sep = "\t", row.names = NULL, header = TRUE)
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_ctrbs$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Cellular Response to Biotic Stimulus"
pdf(file = "cellular_response_to_biotic_stimulus.pdf")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_crtbs$MGI.Gene.Marker.ID))),]
go_crtbs <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\cellular_response_to_biotic_stimulus.txt", sep = "\t", row.names = NULL, header = TRUE)
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_ctrbs$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Cellular Response to Biotic Stimulus"
pdf(file = "cellular_response_to_biotic_stimulus.pdf")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_crtbs$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Cellular Response to Biotic Stimulus"
pdf(file = "cellular_response_to_biotic_stimulus_sig.pdf")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(as.vector(go_crtbs$MGI.Gene.Marker.ID))),]
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Cellular Response to Biotic Stimulus"
pdf(file = "cellular_response_to_biotic_stimulus_sig60.pdf")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
# write.table(normcounts_group,paste0(outdir,outfilename,"/",'cluster',i,'.txt', sep=""), sep="\t",append = FALSE, quote = FALSE)}
require("knitr")
knitr::opts_chunk$set(echo = TRUE)
opts_knit$set(root.dir = "C:\\GitHub\\dnFGFR\\deseq_outputs\\")
library(dplyr)
library(DESeq2)
library(knitr)
library(ggplot2)
library(magrittr)
library(tidyr)
library(tibble)
library(DEGreport)
library(vsn)
counts = read.table("refcounts.txt", header=TRUE, row.names=1, sep="\t")
coldata = read.table("coldata.txt", header=TRUE, sep="\t")
coldata$group<-paste(coldata$genotype, coldata$time, coldata$housing, sep="_")
coldata$timehousing <- paste(coldata$time, coldata$housing, sep="_")
coldata$housing <- factor(coldata$housing, levels = c("same","opposite"))
coldata$genotype <- factor(coldata$genotype, levels = c("ctrl", "dnFGFR"))
coldata$time <- factor(coldata$time, levels = c("PN60",  "PN140"))
coldata$group <- factor(coldata$group)
coldata$timehousing <- factor(coldata$timehousing, levels = c("PN60_same", "PN60_opposite","PN140_same", "PN140_opposite"))
coldata$parent <- factor(coldata$parent)
coldata$dod <- factor(coldata$dod)
#remove length from counts table and sort properly
counts['Length'] = NULL
counts <- counts[,coldata$sampleName]
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
# Create DESeq object
dds = DESeqDataSetFromMatrix(countData = counts, colData = coldata, design = ~ genotype + timehousing)
# Run DESeq on the DESeq object
dds = DESeq(dds)
plotDispEsts(dds)
res <- results(dds, contrast = c("timehousing", "PN140_opposite", "PN140_same"))
normed = counts(dds, normalized=TRUE)
resSig <- subset(res, padj < 0.05)
rs <- as.data.frame(resSig)
siggenes <- as.vector(rownames(rs))
# # Creating a PDF of each gene identified above
# setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\figures\\")
# for (genename in siggenes){
#   n <- paste(genename,"pdf", sep = ".")
#   pdf(file = n, onefile = FALSE, title = genename)
#   plotCounts(dds,gene=genename,intgroup= "timehousing")
#   dev.off()}
# # Write out results
# write.csv(as.data.frame(res), file="timehousing-genotype_results.csv")
#
# # Create MA Plot, alpha is FDR cutoff, for this experiment it is "0.05"
# pdf("timehousing-genotype_MAPlot.pdf")
# DESeq2::plotMA(res, alpha = 0.05, ylim=c(-3,3), cex=.4)
# abline(h=c(-1,1), col="dodgerblue", lwd=2)
# dev.off()
#
# # Write out normalized counts
# write.csv(normed, file="normCounts.csv")
#
# # Plot dispersions
# pdf("timehousing-genotype_dispersionPlot.pdf")
# plotDispEsts(dds)
# dev.off()
mininorm <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(siggenes)))]
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(siggenes)))]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
pdf(file = "deg_heatmap.pdf")
heatmap(mininorm, Colv = NA, main=title)
View(normed)
View(mininorm)
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes))]
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
View(mininorm)
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
pdf(file = "deg_heatmap.pdf")
heatmap(mininorm, Colv = NA, main=title)
dev.off()
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
png(filename = "deg_heatmap.pdf")
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
png(filename = "deg_heatmap.png")
heatmap(mininorm, Colv = NA, main=title)
dev.off()
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
png(filename = "deg_heatmap.png", width = 1000, height = 1000)
heatmap(mininorm, Colv = NA, main=title)
dev.off()
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
png(filename = "deg_heatmap.png", width = 6, height = 6, units = "inch", res = 600)
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
png(filename = "deg_heatmap.png", width = 6, height = 6, units = "in", res = 600)
heatmap(mininorm, Colv = NA, main=title)
dev.off()
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
png(filename = "deg_heatmap.png", width = 6, height = 6, units = "in", res = 800)
heatmap(mininorm, Colv = NA, main=title)
dev.off()
png(filename = "deg_heatmap.png", width = 6, height = 6, units = "in", res = 800, bg= "NA")
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
png(filename = "deg_heatmap.png", width = 6, height = 6, units = "in", res = 800, bg= "NA")
heatmap(mininorm, Colv = NA, main=title)
dev.off()
View(normed)
#Generate Heatmap of DEGs
mininorm <- normed[noquote(rownames(normed)) %in% noquote(as.vector(siggenes)),]
mininorm <- as.matrix(mininorm)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\")
title = "Differentially Expressed Genes"
png(filename = "deg_heatmap.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(mininorm, Colv = NA, main=title)
dev.off()
go_procp <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\positive_regulation_of_cytokine_production.txt", sep = "\t", row.names = NULL, header = TRUE)
# normed140 <- as.data.frame(normed)
# normed140 <- select(normed140, contains("B"))
# normed140 <- log(normed140[!(apply(normed140, 1, function(y) any(y == 0))),])
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
png(filename = "positive_regulation_of_cytokine_production.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
png(filename = "positive_regulation_of_cytokine_production_sig.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(as.vector(go_procp$MGI.Gene.Marker.ID))),]
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Positive Regulation of Cytokine Production"
png(filename = "positive_regulation_of_cytokine_production.png_sig60", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
go_iir <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\innate_immune_response.txt", sep = "\t", row.names = NULL, header = TRUE)
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
png(filename = "innate_immune_response.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
png(filename = "innate_immune_response_sig.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(as.vector(go_iir$MGI.Gene.Marker.ID))),]
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Innate Immune Response"
png(filename = "innate_immune_response_sig60.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
go_crtbs <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\cellular_response_to_biotic_stimulus.txt", sep = "\t", row.names = NULL, header = TRUE)
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_ctrbs$MGI.Gene.Marker.ID))),]
go_ctrbs <- read.table("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\cellular_response_to_biotic_stimulus.txt", sep = "\t", row.names = NULL, header = TRUE)
mininormed <- normed[noquote(rownames(normed)) %in% noquote(unique(as.vector(go_ctrbs$MGI.Gene.Marker.ID))),]
mininormed <- as.matrix(mininormed)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Cellular Response to Biotic Stimulus"
png(filename = "cellular_response_to_biotic_stimulus.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(mininormed, Colv = NA, main=title)
dev.off()
minisig140 <- select(as.data.frame(normed), contains("B"))
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(as.vector(go_crtbs$MGI.Gene.Marker.ID))),]
minisig140 <- minisig140[noquote(rownames(minisig140)) %in% noquote(unique(siggenes)),]
minisig140 <- as.matrix(minisig140)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Cellular Response to Biotic Stimulus"
png(filename = "cellular_response_to_biotic_stimulus_sig.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(minisig140, Colv = NA, main=title)
dev.off()
minisig60 <- select(as.data.frame(normed), contains("A"))
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(as.vector(go_crtbs$MGI.Gene.Marker.ID))),]
minisig60 <- minisig60[noquote(rownames(minisig60)) %in% noquote(unique(siggenes)),]
minisig60 <- as.matrix(minisig60)
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\Go_heatmaps\\")
title = "Cellular Response to Biotic Stimulus"
png(filename = "cellular_response_to_biotic_stimulus_sig60.png", width = 12, height = 12, units = "in", res = 800, bg= "NA")
heatmap(minisig60, Colv = NA, main=title)
dev.off()
# write.table(normcounts_group,paste0(outdir,outfilename,"/",'cluster',i,'.txt', sep=""), sep="\t",append = FALSE, quote = FALSE)}
# Creating a PDF of each gene identified above
setwd("C:\\GitHub\\dnFGFR\\deseq_outputs\\timehousing\\housing\\figures\\")
for (genename in siggenes){
n <- paste(genename,"png", sep = ".")
png(filename = n, width = 12, height = 12, units = "in", res = 800, bg= "NA")
plotCounts(dds,gene=genename,intgroup= "timehousing")
dev.off()}
