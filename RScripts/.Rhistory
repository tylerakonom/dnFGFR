# cluster_columns = FALSE, col = col_fun,
# row_title = "Gene ID",
# row_names_gp = gpar(fontsize = 8),
# column_title = "Sample Name",
# row_title_rot = 90,
# column_title_side = "bottom",
# column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
View(effect_housing_dnFGFR_res)
threshold = 0.1
summary(effect_housing_control_res, alpha = threshold)
plotMA(effect_housing_control_res, alpha = threshold)
summary(effect_housing_dnFGFR_res, alpha = threshold)
plotMA(effect_housing_dnFGFR_res, alpha = threshold)
effect_housing_dnFGFR_res[order(effect_housing_dnFGFR_res$padj), ]
effect_housing_control_res[order(effect_housing_control_res$padj), ]
normed = counts(dds, normalized=TRUE)
# write.csv(normed, file="normCounts.csv")
siggenes <- rownames(effect_housing_dnFGFR_res)
normedsig <- as.data.frame(normed) %>% filter(rownames(normed) %in% siggenes)
View(normedsig)
rowSigma <- apply(normedsig, 1, sd, na.rm = TRUE)
rowMu <- rowMeans(normedsig, na.rm = TRUE)
zscore_norm_expression <- (normedsig - rowMu) / rowSigma
View(zscore_norm_expression)
View(zscore_norm_expression)
# write.csv(normed, file="normCounts.csv")
siggenes <- rownames(effect_housing_dnFGFR_res)
normedsig <- as.data.frame(normed) %>% filter(rownames(normed) %in% siggenes)
View(normedsig)
View(effect_housing_dnFGFR_res)
resSig <- as.data.frame(subset(effect_housing_dnFGFR_res, padj < threshold))
View(resSig)
View(resSig)
normedsig <- as.data.frame(normed) %>% filter(rownames(normed) %in% resSig)
View(normedsig)
# write.csv(normed, file="normCounts.csv")
siggenes <- rownames(resSig)
normedsig <- as.data.frame(normed) %>% filter(rownames(normed) %in% siggenes)
View(normedsig)
normed = counts(dds, normalized=TRUE)
# write.csv(normed, file="normCounts.csv")
resSig <- as.data.frame(subset(effect_housing_dnFGFR_res, padj < threshold))
siggenes <- rownames(resSig)
normedsig <- as.data.frame(normed) %>% filter(rownames(normed) %in% siggenes)
rowSigma <- apply(normedsig, 1, sd, na.rm = TRUE)
rowMu <- rowMeans(normedsig, na.rm = TRUE)
zscore_norm_expression <- (normedsig - rowMu) / rowSigma
col_fun = circlize::colorRamp2(c(-2, 0, 2), c("blue", "white", "red"))
ht <- Heatmap(name = "PN320", as.matrix(zscore_norm_expression),
# cluster_columns = FALSE, col = col_fun,
# row_title = "Gene ID",
# row_names_gp = gpar(fontsize = 8),
# column_title = "Sample Name",
# row_title_rot = 90,
# column_title_side = "bottom",
# column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
ht <- Heatmap(name = "PN320", as.matrix(zscore_norm_expression),
cluster_columns = FALSE, col = col_fun,
row_title = "Gene ID",
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
normed = counts(dds, normalized=TRUE)
# write.csv(normed, file="normCounts.csv")
siggenes <- rownames(effect_housing_dnFGFR_res)
normedsig <- as.data.frame(normed) %>% filter(rownames(normed) %in% siggenes)
rowSigma <- apply(normedsig, 1, sd, na.rm = TRUE)
rowMu <- rowMeans(normedsig, na.rm = TRUE)
zscore_norm_expression <- (normedsig - rowMu) / rowSigma
col_fun = circlize::colorRamp2(c(-2, 0, 2), c("blue", "white", "red"))
resSig <- as.data.frame(subset(effect_housing_dnFGFR_res, padj < threshold))
View(resSig)
resSigRows <- rownames(resSig)
zscore_sig <- as.data.frame(zscore_norm_expression) %>% filter(rownames(zscore_norm_expression) %in% resSigRows)
View(zscore_sig)
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
# cluster_columns = FALSE, col = col_fun,
# row_title = "Gene ID",
# row_names_gp = gpar(fontsize = 8),
# column_title = "Sample Name",
# row_title_rot = 90,
# column_title_side = "bottom",
# column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
normed = counts(dds, normalized=TRUE)
# write.csv(normed, file="normCounts.csv")
siggenes <- rownames(effect_housing_dnFGFR_res)
normedsig <- as.data.frame(normed) %>% filter(rownames(normed) %in% siggenes)
rowSigma <- apply(normedsig, 1, sd, na.rm = TRUE)
rowMu <- rowMeans(normedsig, na.rm = TRUE)
zscore_norm_expression <- (normedsig - rowMu) / rowSigma
col_fun = circlize::colorRamp2(c(-2, 0, 2), c("blue", "white", "red"))
resSig <- as.data.frame(subset(effect_housing_dnFGFR_res, padj < threshold))
resSigRows <- rownames(resSig)
zscore_sig <- as.data.frame(zscore_norm_expression) %>% filter(rownames(zscore_norm_expression) %in% resSigRows)
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
View(normed)
ht
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
# cluster_columns = FALSE, col = col_fun,
# row_title = "Gene ID",
# row_names_gp = gpar(fontsize = 8),
# column_title = "Sample Name",
# row_title_rot = 90,
# column_title_side = "bottom",
# column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
col_fun = circlize::colorRamp2(c(-2, 0, 2), c("blue", "white", "red"))
resSig <- as.data.frame(subset(effect_housing_dnFGFR_res, padj < threshold))
resSigRows <- rownames(resSig)
zscore_sig <- as.data.frame(zscore_norm_expression) %>% filter(rownames(zscore_norm_expression) %in% resSigRows)
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
cluster_columns = FALSE, col = col_fun,
row_title = "Gene ID",
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
column_km = 4
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
cluster_columns = FALSE,
col = col_fun,
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
column_km = 4
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
cluster_columns = FALSE,
col = col_fun,
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
dnFGFR_coldata <- coldataedit %>% filter(!genotype == "ctrl")
zscore_dnFGFR <- zscore_norm_expression %>% select(dnFGFR_coldata$sampleName)
ht_dnFGFR <- Heatmap(name = "PN320", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_title = "Gene ID",
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
zscore_dnFGFR <- zscore_sig %>% select(dnFGFR_coldata$sampleName)
ht_dnFGFR <- Heatmap(name = "PN320", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_title = "Gene ID",
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = dnFGFR, zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht <- Heatmap(name = "PN320", as.matrix(zscore_sig),
cluster_columns = FALSE,
col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
column_title = "Sample Name",
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
Heatmap?
Heatmap(?)
?Heatmap
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = inch(2)
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(6, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(12, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(4, "in"),
heatmap_width = unit(2, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(4, "in"),
heatmap_width = unit(3, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(5, "in"),
heatmap_width = unit(3, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(6, "in"),
heatmap_width = unit(3, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
column_km = 3,
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(6, "in"),
heatmap_width = unit(3, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 2:4))),
column_km = 2,
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
# show_column_names = FALSE,
heatmap_height = unit(6, "in"),
heatmap_width = unit(3, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
top_annotation = HeatmapAnnotation(foo = anno_block(gp = gpar(fill = 1:2))),
column_km = 2,
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
# show_column_names = FALSE,
heatmap_height = unit(6, "in"),
heatmap_width = unit(3, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
# show_column_names = FALSE,
heatmap_height = unit(6, "in"),
heatmap_width = unit(3, "in")
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
# show_column_names = FALSE,
heatmap_height = unit(6, "in"),
heatmap_width = unit(3, "in"),
row_names_gp = gpar(fontsize = 8),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 6),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
# show_column_names = FALSE,
heatmap_height = unit(6, "in"),
heatmap_width = unit(3, "in"),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 6),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(8, "in"),
heatmap_width = unit(4, "in"),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(8, "in"),
heatmap_width = unit(4, "in"),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ht_dnFGFR <- Heatmap(name = "dnFGFR", zscore_dnFGFR, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(10, "in"),
heatmap_width = unit(5, "in"),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_dnFGFR
ctrl_coldata <- coldataedit %>% filter(!genotype == "dnFGFR")
zscore_ctrl <- zscore_sig %>% select(ctrl_coldata$sampleName)
ht_ctrl <- Heatmap(name = "Control", zscore_ctrl, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
show_column_names = FALSE,
heatmap_height = unit(10, "in"),
heatmap_width = unit(5, "in"),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_ctrl
ht_ctrl
ht_ctrl <- Heatmap(name = "Control", zscore_ctrl, cluster_columns = FALSE, col = col_fun,
row_names_gp = gpar(fontsize = 8),
row_title_rot = 90,
column_title_side = "bottom",
column_names_rot = 45,
# show_column_names = FALSE,
heatmap_height = unit(10, "in"),
heatmap_width = unit(5, "in"),
#        show_row_dend = FALSE,
#        show_column_dend = FALSE,
)
ht_ctrl
